# 4월 25일

- jpa 연관관계 필드에서 의문이 들었던게 이해되었다.

  샘플코드에서 연관관계가 있는 두 클래스에 왜? 양쪽에 필드를 생성하고, set이 일어날때 왜 양쪽에다 참조를 넣을까? 라는 의문이 있었다.

  먼저 답을 내리자면, 내가 생각했던 방식이 틀린 생각은 아니였다. 소위 연관관계의 '주인' 클래스에서만 처리하면 될 일이 맞다.

  다만, 이러한 방식은 db의 관점에서 처리 스타일이고, 샘플코드에서 처럼 양쪽 다 필드를 생성하고 set하는 것은 객체지향 스타일이다.

  어떻게 해도 문제될것은 없지만, 자바를 쓰는이상 객체지향 스타일을 지키는것이 좋아보인다.

  그리고 무엇보다. 의미없어 보이던 저 양쪽 모두 set하는 것이 commit 전에 연관객체를 사용할때 빛을 발휘한다.

  주인쪽만 set을 해버리면 commit 전까지는 반대편 객체는 현재 연관 상태라는것을 모른다.

  그러므로 둘다 set을 하면 commit 전에도 서로 연관상태라는것을 알 수 있다. (안한다면, 처리전에 commit을 해야하는 부작용이 따른다.)

  결국 이 모든건 jpa의 캐시 때문에 발생한다. (어쩐지 테스트코드 작성하는데 자꾸 널포인터 에러가 뜨더라...주인만 넣고 반대면은 안넣었으니 널이지..)